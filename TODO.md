# LiteOS å†…æ ¸å®Œå–„è®¡åˆ’

åŸºäºå¯¹å†…æ ¸å’Œç”¨æˆ·ç©ºé—´çš„æ·±å…¥åˆ†æï¼ŒLiteOSå·²ç»å…·å¤‡äº†ç±»Linuxç³»ç»Ÿçš„æ ¸å¿ƒåŸºç¡€æ¶æ„ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†çš„å®Œå–„è®¡åˆ’ã€‚

## æœ€æ–°å®Œæˆè¿›å±•ï¼ˆ2025-07-13ï¼‰

### ğŸ‰ ç¬¬ä¸€é˜¶æ®µé‡å¤§çªç ´ + ç¬¬äºŒé˜¶æ®µæ ¸å¿ƒåŠŸèƒ½

**POSIX å…¼å®¹æ€§åŸºç¡€**å·²å…¨é¢å®Œæˆï¼š

1. **æ–‡ä»¶æè¿°ç¬¦ç®¡ç†ç³»ç»Ÿ**ï¼šå®Œæ•´çš„æ–‡ä»¶æè¿°ç¬¦ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œæ”¯æŒåŠ¨æ€åˆ†é…ã€è‡ªåŠ¨æ¸…ç†å’Œ lseek
2. **è¿›ç¨‹é—´é€šä¿¡ï¼ˆç®¡é“ï¼‰**ï¼šUnix é£æ ¼çš„åŒ¿åç®¡é“å’Œå‘½åç®¡é“ï¼Œæ”¯æŒè¿›ç¨‹é—´æ•°æ®ä¼ è¾“
3. **æ ‡å‡†æµé‡å®šå‘æ”¯æŒ**ï¼šå®Œæ•´çš„ stdin/stdout é‡å®šå‘æœºåˆ¶ï¼Œæ”¯æŒ shell é‡å®šå‘æ“ä½œç¬¦
4. **é«˜çº§è°ƒåº¦ç®—æ³•ç³»ç»Ÿ**ï¼šç°ä»£æ“ä½œç³»ç»Ÿçº§åˆ«çš„å¤šç§è°ƒåº¦ç®—æ³•ï¼ŒåŒ…æ‹¬ CFS å®Œå…¨å…¬å¹³è°ƒåº¦å™¨
5. **ä¿¡å·æœºåˆ¶ç³»ç»Ÿ**ï¼šå®Œæ•´çš„ POSIX ä¿¡å·ç³»ç»Ÿï¼Œæ”¯æŒä¿¡å·å¤„ç†ã€æ©ç ã€è¿›ç¨‹é—´ä¿¡å·é€šä¿¡
6. **æ–‡ä»¶é”æœºåˆ¶ç³»ç»Ÿ**ï¼šå®Œæ•´çš„ POSIX é£æ ¼ advisory æ–‡ä»¶é”ï¼Œæ”¯æŒå…±äº«é”ã€æ’ä»–é”ã€éé˜»å¡æ¨¡å¼
7. **è¿›ç¨‹å‚æ•°ä¼ é€’æœºåˆ¶**ï¼šæ ‡å‡†çš„ argc/argv/envp ä¼ é€’ï¼Œæ”¯æŒ execve ç³»ç»Ÿè°ƒç”¨å’Œç¯å¢ƒå˜é‡ç®¡ç†
8. **æƒé™å’Œå®‰å…¨ç³»ç»Ÿ**ï¼šå®Œæ•´çš„ Unix é£æ ¼æƒé™æ¨¡å‹ï¼ŒåŒ…æ‹¬æ–‡ä»¶æƒé™ã€ç”¨æˆ·æƒé™ã€FAT32 é•¿æ–‡ä»¶åæ”¯æŒ

è¿™å…«ä¸ªåŠŸèƒ½æ„æˆäº†å®Œæ•´çš„ POSIX å…¼å®¹ç³»ç»Ÿè°ƒç”¨æ¥å£ï¼Œä¸º WebAssembly è¿è¡Œæ—¶æä¾›äº†åšå®çš„åŸºç¡€ã€‚LiteOS ç°å·²å…·å¤‡äº†æ„å»ºç°ä»£ WASM è¿è¡Œæ—¶æ‰€éœ€çš„æ‰€æœ‰å†…æ ¸åŠŸèƒ½ã€‚

### ğŸš€ WebAssembly è¿è¡Œæ—¶åŸºç¡€è®¾æ–½

#### å®Œæ•´çš„ POSIX ç³»ç»Ÿè°ƒç”¨æ¥å£

- **æ–‡ä»¶ç³»ç»Ÿæ“ä½œ**ï¼šå®Œæ•´çš„æ–‡ä»¶æè¿°ç¬¦ç®¡ç†ã€æ–‡ä»¶é”ã€æƒé™æ§åˆ¶ï¼Œæ»¡è¶³ WASI æ–‡ä»¶ç³»ç»Ÿéœ€æ±‚
- **è¿›ç¨‹ç®¡ç†**ï¼šforkã€execã€waitã€signal ç­‰å®Œæ•´çš„è¿›ç¨‹ç”Ÿå‘½å‘¨æœŸç®¡ç†
- **è¿›ç¨‹é—´é€šä¿¡**ï¼šç®¡é“ã€ä¿¡å·ç­‰ IPC æœºåˆ¶ï¼Œæ”¯æŒ WASM ç¨‹åºé—´é€šä¿¡
- **è°ƒåº¦ç³»ç»Ÿ**ï¼šå››ç§è°ƒåº¦ç®—æ³•ï¼ˆFIFOã€ä¼˜å…ˆçº§ã€æ—¶é—´ç‰‡è½®è½¬ã€CFSï¼‰ï¼Œä¸º WASM è¿è¡Œæ—¶æä¾›çµæ´»è°ƒåº¦
- **æƒé™å’Œå®‰å…¨**ï¼šå®Œæ•´çš„ Unix é£æ ¼æƒé™æ¨¡å‹ï¼Œä¸º WASM æ²™ç®±æä¾›åŸºç¡€å®‰å…¨ä¿éšœ

### ğŸ”§ WASM è¿è¡Œæ—¶æ”¯æŒç‰¹æ€§

- **WASI å…¼å®¹æ€§**ï¼šå®Œæ•´çš„ POSIX ç³»ç»Ÿè°ƒç”¨æ¥å£ï¼Œæ»¡è¶³ WASI æ ‡å‡†æ‰€æœ‰éœ€æ±‚
- **å®‰å…¨éš”ç¦»**ï¼šåŸºäºæƒé™ç³»ç»Ÿçš„è¿›ç¨‹éš”ç¦»ï¼Œä¸º WASM æ²™ç®±æä¾›åŸºç¡€å®‰å…¨ä¿éšœ
- **æ€§èƒ½ä¼˜åŒ–**ï¼šé«˜æ•ˆçš„è°ƒåº¦ç³»ç»Ÿå’Œèµ„æºç®¡ç†ï¼Œç¡®ä¿ WASM ç¨‹åºé«˜æ€§èƒ½è¿è¡Œ
- **å•çº¿ç¨‹å‹å¥½**ï¼šé¿å…å¤šçº¿ç¨‹å¤æ‚æ€§ï¼Œé€‚åˆå•çº¿ç¨‹äº‹ä»¶å¾ªç¯çš„ WASM è¿è¡Œæ—¶
- **æ ‡å‡†åŒ–**ï¼šå®Œå…¨å…¼å®¹ POSIX æ ‡å‡†ï¼Œä¸ç°æœ‰ WASM å·¥å…·é“¾æ— ç¼é›†æˆ
- **ç¨³å®šæ€§**ï¼šç»è¿‡å……åˆ†æµ‹è¯•çš„å†…æ ¸åŠŸèƒ½ï¼Œç¡®ä¿ WASM è¿è¡Œæ—¶çš„ç¨³å®šæ€§

## å½“å‰çŠ¶æ€è¯„ä¼°

### å·²å®Œæˆçš„æ ¸å¿ƒåŠŸèƒ½ï¼ˆæ”¯æŒ WASM è¿è¡Œæ—¶ï¼‰

**åŸºç¡€å†…æ ¸èƒ½åŠ›**ï¼š

- âœ… åŸºç¡€å†…å­˜ç®¡ç†ï¼ˆå¤šçº§é¡µè¡¨ã€è™šæ‹Ÿå†…å­˜ï¼‰
- âœ… Unix-likeè¿›ç¨‹æ¨¡å‹ï¼ˆfork/exec/waitï¼‰
- âœ… VFSå±‚å’ŒFAT32æ–‡ä»¶ç³»ç»Ÿ
- âœ… VirtIOè®¾å¤‡é©±åŠ¨æ¡†æ¶
- âœ… ä¸­æ–­å’Œå¼‚å¸¸å¤„ç†

**POSIX å…¼å®¹ç³»ç»Ÿè°ƒç”¨**ï¼š

- âœ… **æ–‡ä»¶æè¿°ç¬¦ç®¡ç†ç³»ç»Ÿ**ï¼ˆ2025-07-13å®Œæˆï¼‰
- âœ… **è¿›ç¨‹é—´é€šä¿¡ï¼ˆç®¡é“æœºåˆ¶ï¼‰**ï¼ˆ2025-07-13å®Œæˆï¼‰
- âœ… **æ ‡å‡†æµé‡å®šå‘æ”¯æŒ**ï¼ˆ2025-07-13å®Œæˆï¼‰
- âœ… **è¿›ç¨‹å‚æ•°ä¼ é€’æœºåˆ¶**ï¼ˆ2025-07-13å®Œæˆï¼‰
- âœ… **æƒé™å’Œå®‰å…¨ç³»ç»Ÿ**ï¼ˆ2025-07-13å®Œæˆï¼‰
- âœ… **ä¿¡å·æœºåˆ¶ç³»ç»Ÿ**ï¼ˆ2025-07-13å®Œæˆï¼‰
- âœ… **æ–‡ä»¶é”æœºåˆ¶ç³»ç»Ÿ**ï¼ˆ2025-07-13å®Œæˆï¼‰

**é«˜çº§è°ƒåº¦èƒ½åŠ›**ï¼š

- âœ… **å¤šç§è°ƒåº¦ç®—æ³•ç³»ç»Ÿ**ï¼ˆ2025-07-13å®Œæˆï¼‰- æ”¯æŒ FIFOã€ä¼˜å…ˆçº§ã€æ—¶é—´ç‰‡è½®è½¬ã€CFS

### WASM è¿è¡Œæ—¶æ”¯æŒç°çŠ¶

**âœ… å·²å…·å¤‡çš„åŸºç¡€èƒ½åŠ›**ï¼š

- å®Œæ•´çš„ POSIX ç³»ç»Ÿè°ƒç”¨æ¥å£ï¼ˆæ»¡è¶³ WASI éœ€æ±‚ï¼‰
- è¿›ç¨‹ç®¡ç†å’Œç”Ÿå‘½å‘¨æœŸæ§åˆ¶
- æ–‡ä»¶ç³»ç»Ÿè®¿é—®å’Œæƒé™ç®¡ç†
- è¿›ç¨‹é—´é€šä¿¡æœºåˆ¶ï¼ˆç®¡é“ã€ä¿¡å·ï¼‰
- å®‰å…¨çš„æƒé™éš”ç¦»

**âŒ éœ€è¦å®ç°çš„åŠŸèƒ½**ï¼š

- WebAssembly è¿è¡Œæ—¶æœåŠ¡
- WASI æ ‡å‡†æ¥å£å®ç°
- å¤šè¯­è¨€å·¥å…·é“¾æ”¯æŒ
- è°ƒè¯•å’Œæ€§èƒ½ç›‘æ§å·¥å…·

## å®Œå–„è®¡åˆ’

### ç¬¬ä¸€é˜¶æ®µï¼šWebAssembly è¿è¡Œæ—¶æ ¸å¿ƒï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰

LiteOS å·²ç»å…·å¤‡äº†å®Œæ•´çš„ POSIX ç³»ç»Ÿè°ƒç”¨æ¥å£ï¼Œä¸º WASM è¿è¡Œæ—¶æä¾›äº†åšå®çš„åŸºç¡€ã€‚å½“å‰é˜¶æ®µä¸“æ³¨äºæ„å»º WebAssembly è¿è¡Œæ—¶æœåŠ¡ã€‚

#### 1. åŸºç¡€è¿è¡Œæ—¶æ¶æ„ï¼ˆæ ¸å¿ƒä¼˜å…ˆçº§ï¼‰

**ç›®æ ‡**ï¼šæ„å»ºç”¨æˆ·æ€ WebAssembly è¿è¡Œæ—¶æœåŠ¡

**å…·ä½“ä»»åŠ¡**ï¼š

- [ ] åˆ›å»º `liteos-wasm-runtime` é¡¹ç›®ç»“æ„
- [ ] é›†æˆ wasmtime è¿è¡Œæ—¶å¼•æ“
- [ ] å®ç° `WasmRuntimeService` æ ¸å¿ƒæœåŠ¡
- [ ] å®ç° WASM æ¨¡å—åŠ è½½å’Œç¼–è¯‘
- [ ] å®ç° WASM å®ä¾‹åˆ›å»ºå’Œç®¡ç†
- [ ] å®ç°å•çº¿ç¨‹äº‹ä»¶å¾ªç¯è°ƒåº¦
- [ ] å®ç° IPC é€šä¿¡æ¡†æ¶ï¼ˆUnix Socketï¼‰
- [ ] å®ç°è¿è¡Œæ—¶ç”Ÿå‘½å‘¨æœŸç®¡ç†

**æŠ€æœ¯è¦ç‚¹**ï¼š

- å•çº¿ç¨‹äº‹ä»¶å¾ªç¯æ¶æ„ï¼Œé¿å…å¤šçº¿ç¨‹å¤æ‚æ€§
- åŸºäºç°æœ‰ POSIX ç³»ç»Ÿè°ƒç”¨æ¥å£
- ç”¨æˆ·æ€å®ç°ï¼Œä¸å½±å“å†…æ ¸ç¨³å®šæ€§

**æ¶æ„è®¾è®¡**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    User Space                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   user_shell    â”‚    â”‚      WASM Programs              â”‚ â”‚
â”‚  â”‚                 â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚ ./app.wasm  â”€â”€â” â”‚    â”‚  â”‚ app.wasmâ”‚  â”‚ hello.wasm  â”‚   â”‚ â”‚
â”‚  â”‚               â”‚ â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                  â”‚                        â”‚                 â”‚
â”‚                  â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                  â”‚       â”‚  liteos-wasm-runtime        â”‚   â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â–ºâ”‚                              â”‚   â”‚
â”‚                          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚                          â”‚  â”‚   Wasmtime Engine      â”‚ â”‚   â”‚
â”‚                          â”‚  â”‚                        â”‚ â”‚   â”‚
â”‚                          â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚   â”‚
â”‚                          â”‚  â”‚  â”‚ WASI Interface  â”‚   â”‚ â”‚   â”‚
â”‚                          â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚   â”‚
â”‚                          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚                          â”‚                              â”‚   â”‚
â”‚                          â”‚  POSIX System Call Mapping  â”‚   â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      Kernel Space           â”‚               â”‚
â”‚                                             â–¼               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚            LiteOS Kernel                           â”‚   â”‚
â”‚   â”‚                                                    â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚   â”‚  â”‚ Process  â”‚ â”‚File Sys  â”‚ â”‚  Memory  â”‚ â”‚ Signal â”‚ â”‚   â”‚
â”‚   â”‚  â”‚ Manager  â”‚ â”‚  (VFS)   â”‚ â”‚ Manager  â”‚ â”‚  Mgr   â”‚ â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚   â”‚                                                    â”‚   â”‚
â”‚   â”‚           System Call Interface                    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŒå±‚æŠ½è±¡æœºåˆ¶**ï¼š

```rust
// WASMç¨‹åºè°ƒç”¨WASIæ¥å£
wasi::fd_read(fd, buffer, length) 
    â†“ (åœ¨liteos-wasm-runtimeä¸­)
// WASIæ¥å£æ˜ å°„åˆ°LiteOSç³»ç»Ÿè°ƒç”¨
libc::read(fd, buffer as *mut c_void, length)
    â†“ (é€šè¿‡ç”¨æˆ·åº“åŒ…è£…)
// ç”¨æˆ·æ€ç³»ç»Ÿè°ƒç”¨åŒ…è£…
user_lib::read(fd, buffer, length)
    â†“ (ç³»ç»Ÿè°ƒç”¨è§¦å‘)
// å†…æ ¸æ€ç³»ç»Ÿè°ƒç”¨å¤„ç†
kernel::sys_read(fd, buffer_ptr, length)
```

#### 2. WASI æ ‡å‡†æ¥å£å®ç°ï¼ˆæ ¸å¿ƒä¼˜å…ˆçº§ï¼‰

**ç›®æ ‡**ï¼šå®ç°å®Œæ•´çš„ WASI 1.0 æ ‡å‡†æ¥å£

**å…·ä½“ä»»åŠ¡**ï¼š

- [ ] é›†æˆ `wasmtime-wasi` åº“
- [ ] å®ç° WASI æ–‡ä»¶ç³»ç»Ÿæ¥å£æ˜ å°„
- [ ] å®ç° WASI è¿›ç¨‹ç®¡ç†æ¥å£
- [ ] å®ç° WASI ç¯å¢ƒå˜é‡å’Œå‚æ•°ä¼ é€’
- [ ] å®ç° WASI æ ‡å‡†æµï¼ˆstdin/stdout/stderrï¼‰
- [ ] å®ç° WASI æ—¶é’Ÿå’Œéšæœºæ•°æ¥å£
- [ ] æ·»åŠ  LiteOS ç‰¹å®šæ‰©å±•æ¥å£

**WASI æ¥å£æ˜ å°„**ï¼š

```rust
// æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
wasi::path_open()     â†’ SYSCALL_OPEN      (56)
wasi::fd_read()       â†’ SYSCALL_READ      (63)  
wasi::fd_write()      â†’ SYSCALL_WRITE     (64)
wasi::fd_close()      â†’ SYSCALL_CLOSE     (57)
wasi::fd_seek()       â†’ SYSCALL_LSEEK     (62)
wasi::path_create_directory() â†’ SYSCALL_MKDIR (501)
wasi::path_remove_directory() â†’ SYSCALL_REMOVE (502)
wasi::path_filestat_get()     â†’ SYSCALL_STAT (80)

// è¿›ç¨‹ç®¡ç†
wasi::proc_exit()     â†’ SYSCALL_EXIT      (93)
wasi::sched_yield()   â†’ SYSCALL_YIELD     (124)

// ç¯å¢ƒå˜é‡å’Œå‚æ•°ï¼ˆé€šè¿‡execveä¼ é€’ï¼‰
wasi::args_get()      â†’ ä»execveçš„argvè·å–
wasi::environ_get()   â†’ ä»execveçš„envpè·å–

// æƒé™å’Œå®‰å…¨
wasi::path_open() (æƒé™æ£€æŸ¥) â†’ SYSCALL_CHMOD (507)
                           â†’ SYSCALL_CHOWN (508)
                           â†’ SYSCALL_GETUID (102)
                           â†’ SYSCALL_SETUID (146)

// è¿›ç¨‹é—´é€šä¿¡
wasi æ‰©å±•æ¥å£ â†’ SYSCALL_PIPE      (59)
             â†’ SYSCALL_DUP       (23)
             â†’ SYSCALL_DUP2      (24)
             â†’ SYSCALL_FLOCK     (143)

// ä¿¡å·å¤„ç† (LiteOSæ‰©å±•)
wasi æ‰©å±•æ¥å£ â†’ SYSCALL_KILL      (129)
             â†’ SYSCALL_SIGNAL    (48)
             â†’ SYSCALL_SIGACTION (134)

// è°ƒåº¦æ§åˆ¶ (LiteOSæ‰©å±•)  
wasi æ‰©å±•æ¥å£ â†’ SYSCALL_SETPRIORITY (141)
             â†’ SYSCALL_GETPRIORITY (140)
             â†’ SYSCALL_SCHED_SETSCHEDULER (144)

// å†…å­˜ç®¡ç†
wasi æ‰©å±•æ¥å£ â†’ SYSCALL_BRK       (214)
             â†’ SYSCALL_MMAP      (223)
             â†’ SYSCALL_MUNMAP    (216)
```

**LiteOSå½“å‰å®Œæ•´ç³»ç»Ÿè°ƒç”¨æ”¯æŒ**ï¼š
- âœ… 82ä¸ªç³»ç»Ÿè°ƒç”¨å·²å®ç°ï¼Œæ¶µç›–æ‰€æœ‰WASIæ ‡å‡†éœ€æ±‚
- âœ… å®Œæ•´çš„POSIXå…¼å®¹æ¥å£
- âœ… æ–‡ä»¶ç³»ç»Ÿã€è¿›ç¨‹ç®¡ç†ã€IPCã€ä¿¡å·ã€æƒé™ã€è°ƒåº¦å…¨è¦†ç›–

#### 3. Shell é›†æˆå’Œç”¨æˆ·ä½“éªŒï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰

**ç›®æ ‡**ï¼šè®©ç”¨æˆ·èƒ½å¤Ÿç›´æ¥è¿è¡Œ .wasm æ–‡ä»¶

**å…·ä½“ä»»åŠ¡**ï¼š

- [ ] ä¿®æ”¹ Shell æ”¯æŒ .wasm æ–‡ä»¶è¯†åˆ«
- [ ] å®ç° Shell ä¸è¿è¡Œæ—¶çš„é€šä¿¡
- [ ] å®ç° WASM ç¨‹åºå‚æ•°ä¼ é€’
- [ ] å®ç° WASM ç¨‹åºç¯å¢ƒå˜é‡ä¼ é€’
- [ ] å®ç° WASM ç¨‹åºè¾“å‡ºé‡å®šå‘
- [ ] å®ç° WASM ç¨‹åºä¿¡å·å¤„ç†
- [ ] æ·»åŠ  WASM ç¨‹åºçŠ¶æ€æ˜¾ç¤º

**Shellé›†æˆæœºåˆ¶**ï¼š

```rust
// user_shellä¸­çš„.wasmæ–‡ä»¶å¤„ç†
if command.ends_with(".wasm") {
    // æ–¹å¼1ï¼šç›´æ¥å¯åŠ¨runtimeæœåŠ¡è¿›ç¨‹
    let pid = fork();
    if pid == 0 {
        // å­è¿›ç¨‹ï¼šé€šè¿‡execveè¿è¡Œruntime
        let args = ["liteos-wasm-runtime", wasm_file, ...];
        execve("liteos-wasm-runtime", &args, &envs);
    } else {
        // çˆ¶è¿›ç¨‹ï¼šç­‰å¾…æ‰§è¡Œå®Œæˆ
        wait_pid(pid, &mut exit_code);
    }
    
    // æ–¹å¼2ï¼šé€šè¿‡Unix Domain Socketé€šä¿¡
    // å®ç°æŒä¹…è¿è¡Œçš„runtimeæœåŠ¡è¿›ç¨‹
}
```

**ç”¨æˆ·ä½“éªŒç›®æ ‡**ï¼š

```bash
# ç›´æ¥è¿è¡Œ WASM ç¨‹åº
$ ./hello.wasm
Hello from WebAssembly!

# å¸¦å‚æ•°è¿è¡Œ
$ ./app.wasm arg1 arg2

# æ”¯æŒæ ‡å‡†é‡å®šå‘
$ ./app.wasm > output.txt
$ ./app.wasm < input.txt

# æ”¯æŒç®¡é“æ“ä½œ
$ ./data_gen.wasm | ./data_proc.wasm
```

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- âœ… **å®Œå…¨åŸºäºç°æœ‰å†…æ ¸æ¥å£**ï¼šæ— éœ€ä¿®æ”¹å†…æ ¸ä»£ç 
- âœ… **æ ‡å‡†åŒ–å…¼å®¹**ï¼šåŸºäºWASI 1.0æ ‡å‡†ï¼Œä¸ç°æœ‰WASMå·¥å…·é“¾å®Œå…¨å…¼å®¹
- âœ… **å®‰å…¨éš”ç¦»**ï¼šWASMæ²™ç®± + è¿›ç¨‹éš”ç¦»çš„åŒé‡ä¿æŠ¤
- âœ… **æ€§èƒ½ä¼˜åŒ–**ï¼šç”¨æˆ·æ€å®ç°ï¼Œåˆ©ç”¨wasmtimeçš„JITç¼–è¯‘ä¼˜åŒ–

### ç¬¬äºŒé˜¶æ®µï¼šå¤šè¯­è¨€å·¥å…·é“¾æ”¯æŒï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰

**ç›®æ ‡**ï¼šä¸ºå¤šç§ç¼–ç¨‹è¯­è¨€æä¾›å®Œæ•´çš„ WASM å¼€å‘ç¯å¢ƒ

#### 1. Rust å·¥å…·é“¾

**å…·ä½“ä»»åŠ¡**ï¼š

- [ ] åˆ›å»º Rust WASM é¡¹ç›®æ¨¡æ¿
- [ ] å®ç° `liteos-wasm-std` ç»‘å®šåº“
- [ ] æä¾› LiteOS ç‰¹å®šæ‰©å±• API
- [ ] é…ç½® Cargo.toml æ¨¡æ¿
- [ ] å®ç° Rust è°ƒè¯•ç¬¦å·æ”¯æŒ
- [ ] åˆ›å»º Rust ç¤ºä¾‹é¡¹ç›®é›†

**ç”¨æˆ·ä½“éªŒ**ï¼š

```rust
// æ ‡å‡† Rust å¼€å‘ä½“éªŒ
use std::fs::File;
use std::io::Write;

fn main() -> std::io::Result<()> {
    let mut file = File::create("output.txt")?;
    file.write_all(b"Hello from Rust WASM!")?;
    Ok(())
}
```

#### 2. C/C++ å·¥å…·é“¾

**å…·ä½“ä»»åŠ¡**ï¼š

- [ ] é…ç½® clang/wasi-sdk æ„å»ºç¯å¢ƒ
- [ ] å®ç° `liteos_wasm.h` å¤´æ–‡ä»¶
- [ ] æä¾› C è¯­è¨€ LiteOS æ‰©å±•å‡½æ•°
- [ ] å®ç° C++ æ ‡å‡†åº“å…¼å®¹å±‚
- [ ] é…ç½® CMake æ„å»ºç³»ç»Ÿ
- [ ] åˆ›å»º C/C++ ç¤ºä¾‹é¡¹ç›®

**ç”¨æˆ·ä½“éªŒ**ï¼š

```c
#include <stdio.h>
#include <liteos_wasm.h>

int main() {
    printf("Hello from C WASM!\n");

    // ä½¿ç”¨ LiteOS æ‰©å±•åŠŸèƒ½
    pid_t pid = liteos_fork();
    if (pid == 0) {
        printf("Child process\n");
    }

    return 0;
}
```

#### 3. å…¶ä»–è¯­è¨€æ”¯æŒ

**å…·ä½“ä»»åŠ¡**ï¼š

- [ ] é…ç½® TinyGo æ„å»ºç¯å¢ƒ
- [ ] å®ç° Go è¯­è¨€ LiteOS ç»‘å®š
- [ ] è¯„ä¼° JavaScript/AssemblyScript æ”¯æŒ
- [ ] ç ”ç©¶ Python (Pyodide) æ”¯æŒå¯èƒ½æ€§
- [ ] åˆ›å»ºå¤šè¯­è¨€ç¤ºä¾‹é¡¹ç›®
- [ ] ç¼–å†™è¯­è¨€ç‰¹å®šæ–‡æ¡£

### ç¬¬ä¸‰é˜¶æ®µï¼šç”Ÿäº§çº§ç‰¹æ€§ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰

**ç›®æ ‡**ï¼šå®ç°å®‰å…¨ã€æ€§èƒ½å’Œå¯é æ€§çš„ç”Ÿäº§çº§ç‰¹æ€§

#### 1. å®‰å…¨å’Œèµ„æºç®¡ç†

**ç›®æ ‡**ï¼šä¸º WASM è¿è¡Œæ—¶æä¾›ç”Ÿäº§çº§çš„å®‰å…¨å’Œèµ„æºç®¡ç†

**å…·ä½“ä»»åŠ¡**ï¼š

- [ ] å®ç° WASM å†…å­˜é™åˆ¶å’Œç›‘æ§
- [ ] å®ç° WASM æ‰§è¡Œæ—¶é—´é™åˆ¶
- [ ] å®ç°æ–‡ä»¶ç³»ç»Ÿè®¿é—®æƒé™æ§åˆ¶
- [ ] å®ç°ç½‘ç»œè®¿é—®æƒé™æ§åˆ¶
- [ ] å®ç°ç³»ç»Ÿè°ƒç”¨ç™½åå•æœºåˆ¶
- [ ] å®ç°å®‰å…¨ç­–ç•¥é…ç½®ç³»ç»Ÿ
- [ ] å®ç°èµ„æºä½¿ç”¨ç»Ÿè®¡å’ŒæŠ¥å‘Š
- [ ] å®ç°èµ„æºæ³„æ¼æ£€æµ‹å’Œé¢„è­¦

**å®‰å…¨ç‰¹æ€§**ï¼š

- **æ²™ç®±éš”ç¦»**ï¼šåŒé‡éš”ç¦» (WASM æ²™ç®± + è¿›ç¨‹éš”ç¦»)
- **æƒé™æœ€å°åŒ–**ï¼šç»†ç²’åº¦çš„æƒé™æ§åˆ¶
- **èµ„æºé™åˆ¶**ï¼šé˜²æ­¢èµ„æºè€—å°½æ”»å‡»
- **å®¡è®¡æ—¥å¿—**ï¼šå®Œæ•´çš„å®‰å…¨å®¡è®¡åŠŸèƒ½

#### 2. æ€§èƒ½ä¼˜åŒ–å’Œç›‘æ§

**ç›®æ ‡**ï¼šä¼˜åŒ– WASM è¿è¡Œæ—¶æ€§èƒ½ï¼Œæä¾›å®Œæ•´çš„ç›‘æ§ä½“ç³»

**å…·ä½“ä»»åŠ¡**ï¼š

- [ ] ä¼˜åŒ– WASM æ¨¡å—åŠ è½½å’Œç¼–è¯‘é€Ÿåº¦
- [ ] å®ç° WASM æ¨¡å—ç¼“å­˜æœºåˆ¶
- [ ] ä¼˜åŒ– IPC é€šä¿¡æ€§èƒ½
- [ ] å®ç° JIT ç¼–è¯‘ä¼˜åŒ–
- [ ] å®ç°æ€§èƒ½ç›‘æ§å’Œåˆ†æå·¥å…·
- [ ] ä¼˜åŒ–å†…å­˜åˆ†é…ç­–ç•¥
- [ ] å®ç°è¿è¡Œæ—¶æ€§èƒ½è°ƒä¼˜
- [ ] æ·»åŠ æ€§èƒ½åŸºå‡†æµ‹è¯•å¥—ä»¶

**æ€§èƒ½ç‰¹æ€§**ï¼š

- **æ¨¡å—ç¼“å­˜**ï¼šé¿å…é‡å¤ç¼–è¯‘
- **JIT ä¼˜åŒ–**ï¼šè¿è¡Œæ—¶ä»£ç ä¼˜åŒ–
- **æ€§èƒ½ç›‘æ§**ï¼šå®æ—¶æ€§èƒ½æŒ‡æ ‡
- **å†…å­˜ä¼˜åŒ–**ï¼šå‡å°‘å†…å­˜å ç”¨

#### 3. è°ƒè¯•å’Œå¼€å‘å·¥å…·

**ç›®æ ‡**ï¼šæä¾›å®Œæ•´çš„ WASM ç¨‹åºè°ƒè¯•å’Œå¼€å‘å·¥å…·

**å…·ä½“ä»»åŠ¡**ï¼š

- [ ] å®ç° WASM è°ƒè¯•ç¬¦å·æ”¯æŒ
- [ ] é›†æˆ wasmtime è°ƒè¯•å™¨
- [ ] å®ç° WASM ç¨‹åº coredump ç”Ÿæˆ
- [ ] å®ç° WASM ç¨‹åºæ€§èƒ½åˆ†æå·¥å…·
- [ ] å®ç° WASM ç¨‹åºå†…å­˜åˆ†æå™¨
- [ ] åˆ›å»º WASM ç¨‹åºè¿è¡Œæ—¶ç›‘æ§å·¥å…·
- [ ] å®ç° `liteos-wasm` å‘½ä»¤è¡Œå·¥å…·
- [ ] åˆ›å»º WASM é¡¹ç›®æ¨¡æ¿ç”Ÿæˆå™¨

**å¼€å‘å·¥å…·**ï¼š

- **è°ƒè¯•å™¨é›†æˆ**ï¼šæ”¯æŒæ–­ç‚¹ã€å•æ­¥è°ƒè¯•
- **æ€§èƒ½åˆ†æ**ï¼šCPU å’Œå†…å­˜ä½¿ç”¨åˆ†æ
- **é”™è¯¯è¯Šæ–­**ï¼šè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œå †æ ˆ
- **å¼€å‘è¾…åŠ©**ï¼šæ¨¡æ¿ç”Ÿæˆã€è‡ªåŠ¨åŒ–æ„å»º

### ç¬¬å››é˜¶æ®µï¼šç”Ÿæ€ç³»ç»Ÿå»ºè®¾ï¼ˆä½ä¼˜å…ˆçº§ï¼‰

**ç›®æ ‡**ï¼šæ„å»ºå®Œæ•´çš„ WebAssembly åº”ç”¨ç”Ÿæ€ç³»ç»Ÿ

#### 1. ç¤ºä¾‹åº”ç”¨å’Œæ¨¡æ¿

**å…·ä½“ä»»åŠ¡**ï¼š

- [ ] åˆ›å»ºå¤šè¯­è¨€ "Hello World" ç¤ºä¾‹
- [ ] å®ç° WASM ç‰ˆæœ¬çš„æ–‡ä»¶ç®¡ç†å™¨
- [ ] åˆ›å»º WASM ç‰ˆæœ¬çš„è¿›ç¨‹ç›‘æ§å·¥å…·
- [ ] å®ç°ç®€å•çš„ WASM æ¸¸æˆç¤ºä¾‹
- [ ] åˆ›å»º WASM ç‰ˆæœ¬çš„æ–‡æœ¬ç¼–è¾‘å™¨
- [ ] å®ç° WASM ç‰ˆæœ¬çš„ç½‘ç»œåº”ç”¨
- [ ] åˆ›å»ºé¡¹ç›®æ¨¡æ¿ç”Ÿæˆå™¨
- [ ] å®ç°è‡ªåŠ¨åŒ–æ„å»ºå’Œæµ‹è¯•æµç¨‹

#### 2. Shell åŠŸèƒ½å¢å¼º

**å…·ä½“ä»»åŠ¡**ï¼š

- [ ] å®ç°ç®¡é“æ”¯æŒï¼ˆ|ï¼‰
- [ ] æ·»åŠ åå°è¿›ç¨‹æ‰§è¡Œï¼ˆ&ï¼‰
- [ ] æ”¯æŒä½œä¸šæ§åˆ¶ï¼ˆjobs, fg, bgï¼‰
- [ ] å®ç°å‘½ä»¤å†å²å’Œè¡¥å…¨
- [ ] æ·»åŠ è„šæœ¬æ‰§è¡Œæ”¯æŒ
- [ ] å®ç° WASM ç¨‹åºçš„ç®¡é“é›†æˆ
- [ ] æ”¯æŒ WASM ç¨‹åºçš„åå°æ‰§è¡Œ

#### 3. ç³»ç»Ÿå·¥å…·æ‰©å±•

**å…·ä½“ä»»åŠ¡**ï¼š

- [ ] å®ç° WASM ç‰ˆæœ¬çš„ç³»ç»Ÿç›‘æ§å·¥å…·
- [ ] æ·»åŠ  WASM ç¨‹åºç®¡ç†å·¥å…·
- [ ] å®ç° WASM æ€§èƒ½åˆ†æå·¥å…·
- [ ] æ·»åŠ  WASM èµ„æºç›‘æ§å·¥å…·
- [ ] å®ç° WASM åŒ…ç®¡ç†å™¨åŸå‹
- [ ] åˆ›å»º WASM ç¨‹åºæµ‹è¯•æ¡†æ¶

#### 4. ç½‘ç»œåè®®æ ˆï¼ˆé•¿æœŸç›®æ ‡ï¼‰

**ç›®æ ‡**ï¼šå®ç°åŸºç¡€TCP/IPç½‘ç»œåŠŸèƒ½

**å…·ä½“ä»»åŠ¡**ï¼š

- [ ] å®ç°ç½‘ç»œè®¾å¤‡æŠ½è±¡å±‚
- [ ] æ·»åŠ IP/TCP/UDPåè®®æ ˆ
- [ ] å®ç°socketç³»ç»Ÿè°ƒç”¨
- [ ] æ”¯æŒç½‘ç»œI/Oæ“ä½œ
- [ ] æ·»åŠ ç½‘ç»œé…ç½®ç®¡ç†
- [ ] å®ç° WASM ç½‘ç»œç¼–ç¨‹æ¥å£
- [ ] æ”¯æŒç½‘ç»œ WASM åº”ç”¨

## å®æ–½å»ºè®®

### å¼€å‘é¡ºåº

1. **ç¬¬ä¸€é˜¶æ®µï¼šWebAssembly è¿è¡Œæ—¶æ ¸å¿ƒ**
   - ä¼˜å…ˆå®ç°åŸºç¡€è¿è¡Œæ—¶æ¶æ„
   - å®Œæˆ WASI æ ‡å‡†æ¥å£å®ç°
   - å®ç° Shell é›†æˆï¼Œç¡®ä¿ç”¨æˆ·ä½“éªŒ

2. **ç¬¬äºŒé˜¶æ®µï¼šå¤šè¯­è¨€å·¥å…·é“¾æ”¯æŒ**
   - å¹¶è¡Œå¼€å‘ Rust å’Œ C/C++ å·¥å…·é“¾
   - é€æ­¥æ·»åŠ å…¶ä»–è¯­è¨€æ”¯æŒ
   - æ„å»ºå®Œæ•´çš„å¼€å‘ç¯å¢ƒ

3. **ç¬¬ä¸‰é˜¶æ®µï¼šç”Ÿäº§çº§ç‰¹æ€§**
   - å®ç°å®‰å…¨å’Œèµ„æºç®¡ç†
   - ä¼˜åŒ–æ€§èƒ½å’Œè°ƒè¯•å·¥å…·
   - ç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§

4. **ç¬¬å››é˜¶æ®µï¼šç”Ÿæ€ç³»ç»Ÿå»ºè®¾**
   - æ„å»ºç¤ºä¾‹åº”ç”¨å’Œæ¨¡æ¿
   - å®Œå–„å¼€å‘å·¥å…·é“¾
   - å»ºè®¾ç¤¾åŒºå’Œæ–‡æ¡£

### ä¸‹ä¸€æ­¥å·¥ä½œé‡ç‚¹ï¼ˆæ¨èé¡ºåºï¼‰

1. **WebAssembly è¿è¡Œæ—¶**ï¼šå®ç°ç”¨æˆ·æ€ WASM è¿è¡Œæ—¶ï¼Œæ”¯æŒå¤šè¯­è¨€ç”Ÿæ€
2. **Shell ç®¡é“æ”¯æŒ**ï¼šå®ç°å‘½ä»¤ç®¡é“æ“ä½œç¬¦ï¼ˆ|ï¼‰
3. **ç½‘ç»œåè®®æ ˆ**ï¼šå®ç°åŸºç¡€TCP/IPç½‘ç»œåŠŸèƒ½

#### ä¼˜å…ˆçº§è¯´æ˜

**ç¬¬ä¸€ä¼˜å…ˆçº§ï¼šWebAssembly è¿è¡Œæ—¶æ”¯æŒ**

- è¿™æ˜¯ä»"æ•™å­¦OS"åˆ°"å®ç”¨OS"çš„å…³é”®çªç ´
- æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼ˆRustã€C/C++ã€Goã€JavaScriptç­‰ï¼‰
- æä¾›å®‰å…¨çš„æ²™ç®±æ‰§è¡Œç¯å¢ƒ
- åŸºäº W3C æ ‡å‡†ï¼Œå…·æœ‰è‰¯å¥½çš„ç”Ÿæ€å’Œå…¼å®¹æ€§
- å¤§å¹…æ‰©å±•ç”¨æˆ·ç¾¤ä½“å’Œåº”ç”¨åœºæ™¯

**ç¬¬äºŒä¼˜å…ˆçº§ï¼šç”¨æˆ·ä½“éªŒæ”¹è¿›**

- Shell ç®¡é“æ”¯æŒç­‰åŸºç¡€åŠŸèƒ½
- æå‡ç³»ç»Ÿçš„å®ç”¨æ€§

**ç¬¬ä¸‰ä¼˜å…ˆçº§ï¼šç³»ç»ŸåŠŸèƒ½æ‰©å±•**

- ç½‘ç»œæ”¯æŒç­‰é«˜çº§åŠŸèƒ½
- æå‡ç³»ç»Ÿçš„åŠŸèƒ½å®Œæ•´æ€§

### æœ€æ–°å®ŒæˆçŠ¶æ€

**ç¬¬ä¸€é˜¶æ®µå®Œæˆåº¦ï¼š4/4 (100%)** ğŸ‰
**ç¬¬äºŒé˜¶æ®µå®Œæˆåº¦ï¼š4/4 (100%)** ğŸš€

- âœ… æ–‡ä»¶æè¿°ç¬¦ç®¡ç†ç³»ç»Ÿï¼ˆ2025-07-13å®Œæˆï¼‰
- âœ… è¿›ç¨‹é—´é€šä¿¡ï¼ˆç®¡é“æœºåˆ¶ï¼‰ï¼ˆ2025-07-13å®Œæˆï¼‰
- âœ… æ ‡å‡†æµé‡å®šå‘æ”¯æŒï¼ˆ2025-07-13å®Œæˆï¼‰
- âœ… **è°ƒåº¦ç®—æ³•æ”¹è¿›ï¼ˆ2025-07-13å®Œæˆï¼‰** ğŸ‰
- âœ… **ä¿¡å·æœºåˆ¶ç³»ç»Ÿï¼ˆ2025-07-13å®Œæˆï¼‰** âœ¨ğŸš€
- âœ… **æ–‡ä»¶é”æœºåˆ¶ç³»ç»Ÿï¼ˆ2025-07-13å®Œæˆï¼‰** ğŸ”’
- âœ… **è¿›ç¨‹å‚æ•°ä¼ é€’æœºåˆ¶ï¼ˆ2025-07-13å®Œæˆï¼‰** ğŸ“‹âœ¨
- âœ… **æƒé™å’Œå®‰å…¨ç³»ç»Ÿï¼ˆ2025-07-13å®Œæˆï¼‰** ğŸ”âœ¨

**é‡å¤§æŠ€æœ¯çªç ´**ï¼š

- LiteOSç°å·²å…·å¤‡ç°ä»£æ“ä½œç³»ç»Ÿçº§åˆ«çš„è¿›ç¨‹è°ƒåº¦èƒ½åŠ›ï¼Œæ”¯æŒFIFOã€ä¼˜å…ˆçº§ã€æ—¶é—´ç‰‡è½®è½¬å’ŒCFSå››ç§è°ƒåº¦ç®—æ³•
- å®Œæ•´çš„POSIXä¿¡å·ç³»ç»Ÿå®ç°ï¼ŒåŒ…æ‹¬ä¿¡å·å¤„ç†ã€æ©ç ã€è¿›ç¨‹é—´é€šä¿¡ç­‰æ ¸å¿ƒåŠŸèƒ½
- æ ‡å‡†çš„POSIX execveç³»ç»Ÿè°ƒç”¨ï¼Œæ”¯æŒå®Œæ•´çš„å‚æ•°å’Œç¯å¢ƒå˜é‡ä¼ é€’
- Unixé£æ ¼æƒé™ç³»ç»Ÿï¼ŒåŒ…æ‹¬æ–‡ä»¶æƒé™ã€ç”¨æˆ·æƒé™ç®¡ç†ï¼Œä»¥åŠFAT32é•¿æ–‡ä»¶åæ”¯æŒ
- ç³»ç»Ÿç¨³å®šæ€§å’Œå¹¶å‘å®‰å…¨æ€§è¾¾åˆ°ç”Ÿäº§çº§åˆ«æ ‡å‡†

### è´¨é‡ä¿è¯

- ä¸ºæ¯ä¸ªæ–°åŠŸèƒ½ç¼–å†™æµ‹è¯•ç”¨ä¾‹
- è¿›è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•
- ç¡®ä¿å†…å­˜å®‰å…¨å’Œå¹¶å‘å®‰å…¨
- ç»´æŠ¤è¯¦ç»†çš„æ–‡æ¡£å’Œæ³¨é‡Š

### é•¿æœŸç›®æ ‡

é€šè¿‡ç³»ç»Ÿæ€§çš„æ”¹è¿›ï¼Œå°†LiteOSå‘å±•æˆä¸ºåŸºäº WebAssembly çš„ç°ä»£æ“ä½œç³»ç»Ÿï¼Œé€‚ç”¨äºæ•™å­¦ã€ç ”ç©¶å’Œäº‘åŸç”Ÿåº”ç”¨åœºæ™¯ã€‚

#### å‘å±•è·¯å¾„

**çŸ­æœŸç›®æ ‡ï¼ˆ3-4ä¸ªæœˆï¼‰**ï¼š

- å®ç°å®Œæ•´çš„ WebAssembly è¿è¡Œæ—¶æ”¯æŒ
- æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼ˆRustã€C/C++ã€Goã€JavaScriptï¼‰
- æä¾›å®‰å…¨çš„æ²™ç®±æ‰§è¡Œç¯å¢ƒ
- å¤§å¹…é™ä½å¼€å‘é—¨æ§›å’Œå­¦ä¹ æˆæœ¬

**ä¸­æœŸç›®æ ‡ï¼ˆ6-8ä¸ªæœˆï¼‰**ï¼š

- å®Œå–„ WASM ç”Ÿæ€ç³»ç»Ÿï¼ˆå·¥å…·é“¾ã€è°ƒè¯•å™¨ã€æ€§èƒ½åˆ†æï¼‰
- å®ç°ç”Ÿäº§çº§çš„å®‰å…¨å’Œèµ„æºç®¡ç†
- æ„å»ºå®Œæ•´çš„å¼€å‘å·¥å…·é“¾
- æ”¯æŒå¤æ‚çš„ WASM åº”ç”¨åœºæ™¯

**é•¿æœŸç›®æ ‡ï¼ˆ12ä¸ªæœˆä»¥ä¸Šï¼‰**ï¼š

- å®ç°é«˜æ€§èƒ½ WASM è¿è¡Œæ—¶ä¼˜åŒ–
- æ”¯æŒäº‘åŸç”Ÿå’Œè¾¹ç¼˜è®¡ç®—åº”ç”¨
- æ„å»ºå®Œæ•´çš„ WASM åº”ç”¨ç”Ÿæ€ç³»ç»Ÿ
- è¾¾åˆ°ç”Ÿäº§ç¯å¢ƒå¯ç”¨æ°´å¹³

#### å…³é”®é‡Œç¨‹ç¢‘

**ç¬¬ä¸€é‡Œç¨‹ç¢‘ï¼šWebAssembly è¿è¡Œæ—¶æ”¯æŒ**

- ç”¨æˆ·å¯ä»¥ç›´æ¥è¿è¡Œ .wasm æ–‡ä»¶
- æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼ˆRustã€C/C++ã€Goã€JavaScriptï¼‰
- æä¾›å®‰å…¨çš„æ²™ç®±æ‰§è¡Œç¯å¢ƒ

**ç¬¬äºŒé‡Œç¨‹ç¢‘ï¼šå¼€å‘è€…å‹å¥½**

- å®Œæ•´çš„å¤šè¯­è¨€å·¥å…·é“¾
- ä¸€é”®æ„å»ºå’Œè¿è¡Œ
- å®Œå–„çš„è°ƒè¯•å’Œæ€§èƒ½åˆ†ææ”¯æŒ

**ç¬¬ä¸‰é‡Œç¨‹ç¢‘ï¼šç”Ÿäº§çº§ç‰¹æ€§**

- å®Œæ•´çš„å®‰å…¨å’Œèµ„æºç®¡ç†
- é«˜æ€§èƒ½çš„è¿è¡Œæ—¶ä¼˜åŒ–
- ç¨³å®šçš„ç³»ç»Ÿè¿è¡Œ

**ç¬¬å››é‡Œç¨‹ç¢‘ï¼šç”Ÿæ€ç³»ç»Ÿå»ºè®¾**

- ä¸°å¯Œçš„ç¤ºä¾‹åº”ç”¨å’Œæ¨¡æ¿
- å®Œå–„çš„æ–‡æ¡£å’Œç¤¾åŒºæ”¯æŒ
- æˆç†Ÿçš„ WASM åº”ç”¨ç”Ÿæ€

#### å·²è¾¾æˆçš„é‡Œç¨‹ç¢‘ ğŸ¯

- **å®Œæ•´çš„ POSIX ç³»ç»Ÿè°ƒç”¨æ¥å£** (2025-07-13)ï¼šæ–‡ä»¶ç³»ç»Ÿã€è¿›ç¨‹ç®¡ç†ã€æƒé™ç³»ç»Ÿã€ä¿¡å·æœºåˆ¶ã€æ–‡ä»¶é”ç­‰æ ¸å¿ƒåŠŸèƒ½å…¨é¢å®ç°
- **ç°ä»£åŒ–è°ƒåº¦ç³»ç»Ÿ**ï¼šæ”¯æŒ FIFOã€ä¼˜å…ˆçº§ã€æ—¶é—´ç‰‡è½®è½¬ã€CFS å››ç§è°ƒåº¦ç®—æ³•ï¼Œæ»¡è¶³å„ç§åº”ç”¨éœ€æ±‚
- **Unix é£æ ¼æƒé™æ¨¡å‹**ï¼šå®Œæ•´çš„ç”¨æˆ·æƒé™ã€æ–‡ä»¶æƒé™ã€é•¿æ–‡ä»¶åæ”¯æŒï¼Œç¬¦åˆ POSIX æ ‡å‡†
- **å®Œå–„çš„ IPC æœºåˆ¶**ï¼šç®¡é“ã€ä¿¡å·ã€æ–‡ä»¶é”ç­‰è¿›ç¨‹é—´é€šä¿¡æœºåˆ¶ï¼Œä¸º WASM è¿è¡Œæ—¶æä¾›åŸºç¡€
- **ç”Ÿäº§çº§ç¨³å®šæ€§**ï¼šè§£å†³å¹¶å‘å†²çªã€å†…å­˜å®‰å…¨ç­‰å…³é”®é—®é¢˜ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šè¿è¡Œ

**ğŸ¯ WASM è¿è¡Œæ—¶åŸºç¡€å·²å…·å¤‡**ï¼š

- å®Œæ•´çš„ POSIX ç³»ç»Ÿè°ƒç”¨æ¥å£ï¼ˆæ»¡è¶³ WASI æ ‡å‡†éœ€æ±‚ï¼‰
- å®‰å…¨çš„è¿›ç¨‹ç®¡ç†å’Œæƒé™æ§åˆ¶
- é«˜æ•ˆçš„è°ƒåº¦å’Œèµ„æºç®¡ç†
- ç¨³å®šçš„æ–‡ä»¶ç³»ç»Ÿå’Œ IPC æœºåˆ¶

#### ä¸‹é˜¶æ®µç›®æ ‡

- **ç¬¬ä¸€é˜¶æ®µ**ï¼šWebAssembly è¿è¡Œæ—¶æ ¸å¿ƒ ğŸš€ **å¼€å§‹å®æ–½**
- **ç¬¬äºŒé˜¶æ®µ**ï¼šå¤šè¯­è¨€å·¥å…·é“¾æ”¯æŒ
- **ç¬¬ä¸‰é˜¶æ®µ**ï¼šç”Ÿäº§çº§ç‰¹æ€§å®Œå–„
- **ç¬¬å››é˜¶æ®µ**ï¼šç”Ÿæ€ç³»ç»Ÿå»ºè®¾

LiteOSå·²ç»ä»ä¸€ä¸ªæ•™å­¦ç”¨çš„ç®€å•å†…æ ¸å‘å±•æˆä¸ºå…·å¤‡å®Œæ•´ POSIX å…¼å®¹æ€§çš„ç°ä»£æ“ä½œç³»ç»Ÿï¼Œä¸ºæ„å»º WebAssembly è¿è¡Œæ—¶æä¾›äº†åšå®çš„åŸºç¡€ã€‚ç°åœ¨å·²å®Œæˆäº†æ‰€æœ‰æ ¸å¿ƒçš„ç³»ç»Ÿè°ƒç”¨æ¥å£å’Œå†…æ ¸åŠŸèƒ½ï¼Œå‡†å¤‡å‘åŸºäº WebAssembly çš„ç°ä»£æ“ä½œç³»ç»Ÿæ¶æ„è½¬å˜ã€‚

#### ä¸‹ä¸€æ­¥é‡ç‚¹ï¼šWebAssembly è¿è¡Œæ—¶æ”¯æŒ ğŸš€

**WebAssembly è¿è¡Œæ—¶æ”¯æŒ**æ˜¯LiteOSå‘å±•çš„å…³é”®è½¬æŠ˜ç‚¹ï¼ŒåŸºäºå®Œæ•´çš„æ¶æ„è®¾è®¡ï¼š

**æŠ€æœ¯æ¶æ„ä¼˜åŠ¿**ï¼š
1. **åŒå±‚æŠ½è±¡è®¾è®¡**ï¼šWASMè¿è¡Œæ—¶ â†’ POSIXç³»ç»Ÿè°ƒç”¨ â†’ å†…æ ¸æ¥å£
2. **å®Œæ•´ç³»ç»Ÿè°ƒç”¨è¦†ç›–**ï¼š82ä¸ªå·²å®ç°çš„POSIXç³»ç»Ÿè°ƒç”¨æ¶µç›–æ‰€æœ‰WASIéœ€æ±‚
3. **æ— å†…æ ¸ä¿®æ”¹**ï¼šçº¯ç”¨æˆ·æ€å®ç°ï¼Œä¿æŒå†…æ ¸ç®€æ´æ€§
4. **æ ‡å‡†åŒ–å…¼å®¹**ï¼šåŸºäºwasmtimeå’ŒWASI 1.0æ ‡å‡†

**å‘å±•ä»·å€¼**ï¼š
1. **å½»åº•æ”¹å˜ç”¨æˆ·ä½“éªŒ**ï¼šä»å•ä¸€è¯­è¨€åˆ°å¤šè¯­è¨€ç”Ÿæ€ç³»ç»Ÿ
2. **å¤§å¹…æ‰©å±•åº”ç”¨ç”Ÿæ€**ï¼šæ”¯æŒ Rustã€C/C++ã€Goã€JavaScript ç­‰å¤šç§è¯­è¨€  
3. **é™ä½å¼€å‘é—¨æ§›**ï¼šç”¨æˆ·å¯ä»¥ä½¿ç”¨ç†Ÿæ‚‰çš„ç¼–ç¨‹è¯­è¨€
4. **æå‡å®ç”¨ä»·å€¼**ï¼šä»æ•™å­¦å·¥å…·è½¬å‘å®ç”¨ç³»ç»Ÿ
5. **å¢å¼ºå®‰å…¨æ€§**ï¼šå¤©ç„¶çš„æ²™ç®±éš”ç¦»å’Œæƒé™æ§åˆ¶

**å®æ–½è·¯çº¿**ï¼š
- âœ… **åŸºç¡€è®¾æ–½å®Œå¤‡**ï¼šå®Œæ•´çš„POSIXç³»ç»Ÿè°ƒç”¨æ¥å£å·²å°±ç»ª
- ğŸš€ **æ ¸å¿ƒè¿è¡Œæ—¶**ï¼šç”¨æˆ·æ€ WASM è¿è¡Œæ—¶æœåŠ¡ (liteos-wasm-runtime)
- ğŸš€ **Shellé›†æˆ**ï¼šæ”¯æŒ .wasm æ–‡ä»¶ç›´æ¥æ‰§è¡Œï¼Œå®Œæ•´é‡å®šå‘å’Œç®¡é“æ”¯æŒ
- ğŸš€ **å¤šè¯­è¨€å·¥å…·é“¾**ï¼šRustã€C/C++ã€Goç­‰è¯­è¨€çš„å®Œæ•´å¼€å‘ç¯å¢ƒ
- ğŸš€ **é›¶å†…æ ¸ä¿®æ”¹**ï¼šä¿æŒç°æœ‰å†…æ ¸æ¶æ„ä¸å˜ï¼Œç¡®ä¿ç¨³å®šæ€§

**é¢„æœŸæ•ˆæœ**ï¼š
ç”¨æˆ·æœ€ç»ˆå¯ä»¥å†™å‡ºè¿™æ ·çš„ä»£ç ï¼š

```rust
// Rust ç¨‹åº
use std::fs::File;
use std::io::Write;

fn main() -> std::io::Result<()> {
    println!("Hello from Rust WASM!");
    let mut file = File::create("test.txt")?;
    file.write_all(b"Hello, world!")?;
    Ok(())
}
```

```c
// C ç¨‹åº
#include <stdio.h>
int main() {
    printf("Hello from C WASM!\n");
    return 0;
}
```

å¹¶ä¸”å¯ä»¥ç›´æ¥åœ¨ Shell ä¸­è¿è¡Œï¼š

```bash
$ ./rust_app.wasm
Hello from Rust WASM!
$ ./c_app.wasm
Hello from C WASM!
```

è¿™å°†æ˜¯LiteOSå‘å±•å²ä¸Šçš„é‡è¦é‡Œç¨‹ç¢‘ï¼Œæ ‡å¿—ç€ç³»ç»Ÿä»æ¦‚å¿µéªŒè¯èµ°å‘å®é™…åº”ç”¨çš„å…³é”®ä¸€æ­¥ã€‚

## é¡¹ç›®ç»“æ„è§„åˆ’

### å®Œæ•´çš„ç³»ç»Ÿæ¶æ„

```
lite_os/
â”œâ”€â”€ kernel/                      # LiteOS å†…æ ¸ï¼ˆå·²å®Œæˆï¼‰
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ syscall/            # å®Œæ•´çš„ POSIX ç³»ç»Ÿè°ƒç”¨
â”‚   â”‚   â”œâ”€â”€ task/               # è¿›ç¨‹ç®¡ç†å’Œè°ƒåº¦
â”‚   â”‚   â”œâ”€â”€ fs/                 # æ–‡ä»¶ç³»ç»Ÿï¼ˆFAT32 + VFSï¼‰
â”‚   â”‚   â”œâ”€â”€ memory/             # å†…å­˜ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ ipc/                # è¿›ç¨‹é—´é€šä¿¡
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ ...
â”œâ”€â”€ liteos-wasm-runtime/         # WASM è¿è¡Œæ—¶æœåŠ¡ï¼ˆå¾…å®ç°ï¼‰
â”‚   â”œâ”€â”€ Cargo.toml
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.rs             # è¿è¡Œæ—¶æœåŠ¡ä¸»å…¥å£
â”‚   â”‚   â”œâ”€â”€ runtime.rs          # WASM è¿è¡Œæ—¶æ ¸å¿ƒ
â”‚   â”‚   â”œâ”€â”€ instance.rs         # WASM å®ä¾‹ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ ipc.rs              # IPC é€šä¿¡æ¥å£
â”‚   â”‚   â”œâ”€â”€ wasi_ext.rs         # WASI æ‰©å±•æ¥å£
â”‚   â”‚   â”œâ”€â”€ security.rs         # å®‰å…¨å’Œæƒé™æ§åˆ¶
â”‚   â”‚   â””â”€â”€ monitor.rs          # æ€§èƒ½ç›‘æ§
â”‚   â””â”€â”€ config/                 # é…ç½®æ–‡ä»¶
â”‚       â”œâ”€â”€ runtime.toml        # è¿è¡Œæ—¶é…ç½®
â”‚       â””â”€â”€ security.toml       # å®‰å…¨ç­–ç•¥é…ç½®
â”œâ”€â”€ liteos-wasm-std/             # å¤šè¯­è¨€ç»‘å®šåº“ï¼ˆå¾…å®ç°ï¼‰
â”‚   â”œâ”€â”€ rust/                   # Rust ç»‘å®š
â”‚   â”‚   â”œâ”€â”€ Cargo.toml
â”‚   â”‚   â””â”€â”€ src/lib.rs
â”‚   â”œâ”€â”€ c/                      # C ç»‘å®š
â”‚   â”‚   â”œâ”€â”€ liteos_wasm.h
â”‚   â”‚   â””â”€â”€ CMakeLists.txt
â”‚   â””â”€â”€ go/                     # Go ç»‘å®š
â”‚       â”œâ”€â”€ go.mod
â”‚       â””â”€â”€ liteos.go
â”œâ”€â”€ wasm-examples/               # å¤šè¯­è¨€ç¤ºä¾‹ï¼ˆå¾…å®ç°ï¼‰
â”‚   â”œâ”€â”€ rust/
â”‚   â”‚   â”œâ”€â”€ hello_world/
â”‚   â”‚   â”œâ”€â”€ file_operations/
â”‚   â”‚   â””â”€â”€ process_management/
â”‚   â”œâ”€â”€ c/
â”‚   â”‚   â”œâ”€â”€ hello_world/
â”‚   â”‚   â””â”€â”€ file_operations/
â”‚   â””â”€â”€ go/
â”‚       â””â”€â”€ hello_world/
â”œâ”€â”€ tools/                       # æ„å»ºå’Œè°ƒè¯•å·¥å…·ï¼ˆå¾…å®ç°ï¼‰
â”‚   â”œâ”€â”€ liteos-wasm             # å‘½ä»¤è¡Œå·¥å…·
â”‚   â”œâ”€â”€ wasm-debug/             # è°ƒè¯•å·¥å…·
â”‚   â””â”€â”€ templates/              # é¡¹ç›®æ¨¡æ¿
â”œâ”€â”€ user/                        # ç°æœ‰ç”¨æˆ·ç¨‹åºï¼ˆä¿æŒå…¼å®¹ï¼‰
â”œâ”€â”€ bootloader/                  # å¼•å¯¼åŠ è½½å™¨ï¼ˆå·²å®Œæˆï¼‰
â””â”€â”€ (å…¶ä»–ç°æœ‰ç»„ä»¶...)
```

### æ ¸å¿ƒè®¾è®¡åŸåˆ™

1. **å†…æ ¸ç®€æ´æ€§**ï¼šWASM è¿è¡Œæ—¶åœ¨ç”¨æˆ·æ€ï¼Œä¸å¢åŠ å†…æ ¸å¤æ‚æ€§
2. **POSIX å…¼å®¹æ€§**ï¼šå……åˆ†åˆ©ç”¨å·²æœ‰çš„ POSIX ç³»ç»Ÿè°ƒç”¨æ¥å£
3. **å®‰å…¨éš”ç¦»**ï¼šåŒé‡æ²™ç®±ï¼ˆWASM + è¿›ç¨‹ï¼‰ç¡®ä¿å®‰å…¨æ€§
4. **æ€§èƒ½ä¼˜åŒ–**ï¼šå•çº¿ç¨‹äº‹ä»¶å¾ªç¯ï¼Œé¿å…å¤šçº¿ç¨‹å¤æ‚æ€§
5. **æ ‡å‡†åŒ–**ï¼šåŸºäº WASI æ ‡å‡†ï¼Œç¡®ä¿å…¼å®¹æ€§

---

*æ­¤è®¡åˆ’åŸºäºå¯¹å½“å‰LiteOSä»£ç åº“çš„æ·±å…¥åˆ†æï¼ŒæŒ‰ä¼˜å…ˆçº§å’Œä¾èµ–å…³ç³»å®‰æ’ã€‚å»ºè®®æ ¹æ®å…·ä½“éœ€æ±‚å’Œèµ„æºæƒ…å†µè°ƒæ•´å®æ–½é¡ºåºã€‚*
